(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[188],{8188:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AuthenticationModule:()=>qe});var n=r(8583),i=r(7716),s=r(7053),o=r(1558);let a=(()=>{class e{constructor(e,t,r){this._authService=e,this._router=t,this._route=r,this.errorMessage="",this.showError=!0,this._returnUrl="/",this.externalLogin=()=>{this.showError=!1,this._authService.signInWithGoogle().then(e=>{const t=Object.assign({},e);this.validateExternalAuth(t)},e=>console.log(e))},this.externalLoginFB=()=>{this.showError=!1,this._authService.signInWithFB().then(e=>{const t=Object.assign({},e);this.validateExternalAuth(t)},e=>console.log(e))}}ngOnDestroy(){var e;null===(e=this.externalLoginSubscription)||void 0===e||e.unsubscribe()}ngOnInit(){this._returnUrl=this._route.snapshot.queryParams.returnUrl||"/"}validateExternalAuth(e){this.externalLoginSubscription=this._authService.externalLogin("accounts/externallogin",{provider:e.provider,idToken:e.idToken,authToken:e.authToken}).subscribe(t=>{localStorage.setItem("token",t.token),this._authService.sendAuthStateChangeNotification(e),this._router.navigate([this._returnUrl])},e=>{this.errorMessage=e,this.showError=!0,this._authService.signOutExternal()})}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(s.$),i.Y36(o.F0),i.Y36(o.gz))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-login"]],decls:10,vars:0,consts:[[1,"card"],[1,"card-body"],[1,"card-title"],[1,"btn","btn-danger","btn-social-icon","btn-google","mx-1",3,"click"],[1,"bi","bi-google","fs-5","btn-danger"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"h1",2),i._uU(3,"Login"),i.qZA(),i.TgZ(4,"div"),i.TgZ(5,"h3"),i._uU(6,"External Providers"),i.qZA(),i.TgZ(7,"button",3),i.NdJ("click",function(){return t.externalLogin()}),i._UZ(8,"i",4),i._uU(9," | Login with google"),i.qZA(),i.qZA(),i.qZA(),i.qZA())},styles:[""]}),e})(),c=(()=>{class e{constructor(e,t){this.authenticationService=e,this.router=t}canActivate(e,t){return!!this.authenticationService.isUserAuthenticated()||(this.router.navigate(["/user/login"],{queryParams:{returnUrl:t.url}}),!1)}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(s.$),i.LFG(o.F0))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var l=r(3679),d=r(8307),u=r(5917),g=r(9517),p=r(2340),h=r(1841);let m=(()=>{class e{constructor(e){this.http=e}updateAddress(e){return this.http.put(p.N.apiUrl+"addresses/"+e.id,e)}addAddress(e){return this.http.post(p.N.apiUrl+"addresses/",e)}getAddresss(){return this.http.get(p.N.apiUrl+"addresses")}getAddress(e){return this.http.get(p.N.apiUrl+"addresses/"+e)}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(h.eN))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var f=r(4283);function Z(e,t){1&e&&i._UZ(0,"app-spinner")}function A(e,t){if(1&e){const e=i.EpF();i.ynx(0),i.TgZ(1,"form",2),i.NdJ("ngSubmit",function(){return i.CHM(e),i.oxw().save()}),i.TgZ(2,"div",3),i.TgZ(3,"h4",4),i._uU(4),i.qZA(),i.TgZ(5,"button",5),i.NdJ("click",function(){return i.CHM(e),i.oxw().activeModal.dismiss("Cross click")}),i.TgZ(6,"span",6),i._uU(7,"\xd7"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(8,"div",7),i.TgZ(9,"div",8),i.TgZ(10,"div",9),i.TgZ(11,"label",10),i._uU(12,"Address"),i.qZA(),i._UZ(13,"input",11),i.TgZ(14,"div",12),i._uU(15," Please enter your address. "),i.qZA(),i.qZA(),i.TgZ(16,"div",9),i.TgZ(17,"label",13),i._uU(18,"Address 2 "),i.TgZ(19,"span",14),i._uU(20,"(Optional)"),i.qZA(),i.qZA(),i._UZ(21,"input",15),i.qZA(),i.TgZ(22,"div",9),i.TgZ(23,"label",16),i._uU(24,"City"),i.qZA(),i._UZ(25,"input",17),i.qZA(),i.TgZ(26,"div",18),i.TgZ(27,"label",19),i._uU(28,"State"),i.qZA(),i.TgZ(29,"select",20),i.TgZ(30,"option"),i._uU(31,"Andhra Pradesh "),i.qZA(),i.TgZ(32,"option"),i._uU(33,"Arunachal Pradesh "),i.qZA(),i.TgZ(34,"option"),i._uU(35,"Assam "),i.qZA(),i.TgZ(36,"option"),i._uU(37,"Bihar "),i.qZA(),i.TgZ(38,"option"),i._uU(39,"Chandigarh "),i.qZA(),i.TgZ(40,"option"),i._uU(41,"Chhattisgarh "),i.qZA(),i.TgZ(42,"option"),i._uU(43,"Dadra and Nagar Haveli"),i.qZA(),i.TgZ(44,"option"),i._uU(45,"Daman and Diu "),i.qZA(),i.TgZ(46,"option"),i._uU(47,"Delhi "),i.qZA(),i.TgZ(48,"option"),i._uU(49,"Goa "),i.qZA(),i.TgZ(50,"option"),i._uU(51,"Gujarat "),i.qZA(),i.TgZ(52,"option"),i._uU(53,"Haryana "),i.qZA(),i.TgZ(54,"option"),i._uU(55,"Himachal Pradesh "),i.qZA(),i.TgZ(56,"option"),i._uU(57,"Jammu and Kashmir "),i.qZA(),i.TgZ(58,"option"),i._uU(59,"Jharkhand "),i.qZA(),i.TgZ(60,"option"),i._uU(61,"Karnataka "),i.qZA(),i.TgZ(62,"option"),i._uU(63,"Kerala "),i.qZA(),i.TgZ(64,"option"),i._uU(65,"Lakshadweep "),i.qZA(),i.TgZ(66,"option"),i._uU(67,"Madhya Pradesh "),i.qZA(),i.TgZ(68,"option"),i._uU(69,"Maharashtra "),i.qZA(),i.TgZ(70,"option"),i._uU(71,"Manipur "),i.qZA(),i.TgZ(72,"option"),i._uU(73,"Meghalaya "),i.qZA(),i.TgZ(74,"option"),i._uU(75,"Mizoram "),i.qZA(),i.TgZ(76,"option"),i._uU(77,"Nagaland "),i.qZA(),i.TgZ(78,"option"),i._uU(79,"Odisha "),i.qZA(),i.TgZ(80,"option"),i._uU(81,"Pondicherry "),i.qZA(),i.TgZ(82,"option"),i._uU(83,"Port Blair "),i.qZA(),i.TgZ(84,"option"),i._uU(85,"Punjab "),i.qZA(),i.TgZ(86,"option"),i._uU(87,"Rajasthan "),i.qZA(),i.TgZ(88,"option"),i._uU(89,"Sikkim "),i.qZA(),i.TgZ(90,"option"),i._uU(91,"Tamil Nadu "),i.qZA(),i.TgZ(92,"option"),i._uU(93,"Telangana "),i.qZA(),i.TgZ(94,"option"),i._uU(95,"Tripura "),i.qZA(),i.TgZ(96,"option"),i._uU(97,"Uttar Pradesh "),i.qZA(),i.TgZ(98,"option"),i._uU(99,"Uttarakhand "),i.qZA(),i.TgZ(100,"option"),i._uU(101,"West Bengal "),i.qZA(),i.qZA(),i.TgZ(102,"div",12),i._uU(103," Please provide a valid state. "),i.qZA(),i.qZA(),i.TgZ(104,"div",21),i.TgZ(105,"label",22),i._uU(106,"Pin code"),i.qZA(),i._UZ(107,"input",23),i.TgZ(108,"div",12),i._uU(109," Zip code required. "),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.TgZ(110,"div",24),i.TgZ(111,"button",25),i.NdJ("click",function(){return i.CHM(e),i.oxw().activeModal.close()}),i._uU(112,"Close"),i.qZA(),i.TgZ(113,"button",26),i._uU(114,"Save"),i.qZA(),i.qZA(),i.qZA(),i.BQk()}if(2&e){const e=i.oxw();i.xp6(1),i.Q6J("formGroup",e.addressFormGroup),i.xp6(3),i.Oqu(0===e.id?"Add an Address":"Update Address"),i.xp6(109),i.Q6J("disabled",!e.addressFormGroup.valid)}}let v=(()=>{class e{constructor(e,t,r){this.activeModal=e,this.fb=t,this.addressService=r}ngOnDestroy(){var e;null===(e=this.addUpdateSubscription)||void 0===e||e.unsubscribe()}ngOnInit(){this.addressFormGroup=this.fb.group({streetnumber:[{value:"",disabled:!1},[l.kI.required]],streetname:[{value:"",disabled:!1},[]],city:[{value:"",disabled:!1},[l.kI.required]],state:[{value:"Telangana",disabled:!1},[l.kI.required]],zip:[{value:"",disabled:!1},[l.kI.required]],id:[0],userId:[this.userId]}),this.address$=0===this.id?(0,u.of)({}).pipe((0,d.b)(e=>{this.addressFormGroup.patchValue(e)})):this.addressService.getAddress(this.id).pipe((0,d.b)(e=>{this.addressFormGroup.patchValue(e)}))}save(){this.addUpdateSubscription=0===this.id?this.addressService.addAddress(this.addressFormGroup.value).subscribe(()=>{this.activeModal.close("Address added successfully")},e=>{console.error(e),this.activeModal.close("There was a problem adding the address. Please try again.")}):this.addressService.updateAddress(this.addressFormGroup.value).subscribe(()=>{this.activeModal.close("Address updated successfully")},e=>{console.error(e),this.activeModal.close("There was a problem adding the address. Please try again.")})}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(g.Kz),i.Y36(l.qu),i.Y36(m))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-address-edit"]],inputs:{id:"id",userId:"userId"},decls:4,vars:4,consts:[["loading",""],[4,"ngIf","ngIfElse"],["novalidate","",1,"needs-validation",3,"formGroup","ngSubmit"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"row","g-3"],[1,"col-12"],["for","address",1,"form-label"],["type","text","id","address","formControlName","streetnumber","placeholder","1234 Main St","required","",1,"form-control"],[1,"invalid-feedback"],["for","address2",1,"form-label"],[1,"text-muted"],["type","text","id","address2","formControlName","streetname","placeholder","Apartment or suite",1,"form-control"],["for","city",1,"form-label"],["type","text","id","city","formControlName","city","required","","placeholder","City",1,"form-control"],[1,"col-md-4"],["for","state",1,"form-label"],["id","state","formControlName","state","required","",1,"form-select"],[1,"col-md-3"],["for","zip",1,"form-label"],["type","text","id","zip","formControlName","zip","placeholder","","required","",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(e,t){if(1&e&&(i.YNc(0,Z,1,0,"ng-template",null,0,i.W1O),i.YNc(2,A,115,3,"ng-container",1),i.ALo(3,"async")),2&e){const e=i.MAs(1);i.xp6(2),i.Q6J("ngIf",i.lcZ(3,2,t.address$))("ngIfElse",e)}},directives:[n.O5,f.O,l._Y,l.JL,l.sg,l.Fj,l.JJ,l.u,l.Q7,l.EJ,l.YN,l.Kr],pipes:[n.Ov],styles:[""]}),e})();var b=r(9618),q=r(4465);function T(e,t){1&e&&i._UZ(0,"app-spinner")}function y(e,t){if(1&e){const e=i.EpF();i.ynx(0),i.TgZ(1,"div",17),i.TgZ(2,"address"),i._uU(3),i._UZ(4,"br"),i._uU(5),i._UZ(6,"br"),i._uU(7),i._UZ(8,"br"),i._uU(9),i._UZ(10,"br"),i._uU(11),i.qZA(),i.TgZ(12,"button",19),i.NdJ("click",function(){const t=i.CHM(e).$implicit;return i.oxw(3).showAddressDialog(t.id)}),i._uU(13,"Update address"),i.qZA(),i.qZA(),i.BQk()}if(2&e){const e=t.$implicit;i.xp6(3),i.hij(" ",e.streetnumber,""),i.xp6(2),i.Oqu(e.streetname),i.xp6(2),i.Oqu(e.city),i.xp6(2),i.Oqu(e.state),i.xp6(2),i.hij("",e.zip," ")}}function x(e,t){if(1&e&&(i.ynx(0),i._UZ(1,"hr",21),i.YNc(2,y,14,5,"ng-container",22),i._UZ(3,"hr",21),i.BQk()),2&e){const e=i.oxw().ngIf;i.xp6(2),i.Q6J("ngForOf",e.addresses)}}function U(e,t){if(1&e){const e=i.EpF();i.TgZ(0,"div",2),i.TgZ(1,"main"),i.TgZ(2,"div",3),i.TgZ(3,"div",4),i.TgZ(4,"h4",5),i._uU(5,"Update your profile, "),i.TgZ(6,"span",6),i._uU(7),i.qZA(),i.qZA(),i.TgZ(8,"form",7),i.NdJ("ngSubmit",function(){const t=i.CHM(e).ngIf;return i.oxw().save(t.email)}),i.TgZ(9,"div",8),i.TgZ(10,"div",9),i.TgZ(11,"label",10),i._uU(12,"First name"),i.qZA(),i._UZ(13,"input",11),i.TgZ(14,"div",12),i._uU(15," Valid first name is required. "),i.qZA(),i.qZA(),i.TgZ(16,"div",9),i.TgZ(17,"label",13),i._uU(18,"Last name"),i.qZA(),i._UZ(19,"input",14),i.qZA(),i.TgZ(20,"div",9),i.TgZ(21,"label",15),i._uU(22,"Phone Number"),i.qZA(),i._UZ(23,"input",16),i.TgZ(24,"div",12),i._uU(25," Valid phone number is required. "),i.qZA(),i.qZA(),i.TgZ(26,"div",17),i.TgZ(27,"button",18),i._uU(28,"Save"),i.qZA(),i.qZA(),i.TgZ(29,"div",17),i.TgZ(30,"button",19),i.NdJ("click",function(){return i.CHM(e),i.oxw().showAddressDialog(0)}),i._uU(31,"Add an address"),i.qZA(),i.qZA(),i._UZ(32,"br"),i.YNc(33,x,4,1,"ng-container",20),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA()}if(2&e){const e=t.ngIf,r=i.oxw();i.xp6(7),i.Oqu(e.email),i.xp6(1),i.Q6J("id",e.email)("formGroup",r.userFormGroup),i.xp6(19),i.Q6J("disabled",!r.userFormGroup.valid),i.xp6(6),i.Q6J("ngIf",e.addresses&&e.addresses.length)}}let _=(()=>{class e{constructor(e,t,r,n,i,s,o){this.fb=e,this.userProfileService=t,this.authenticationService=r,this.router=n,this.toastService=i,this.modalService=s,this.route=o}ngOnInit(){this.userFormGroup=this.fb.group({firstname:[{value:"",disabled:!1},[l.kI.required]],lastname:[{value:"",disabled:!1},[l.kI.required]],phoneNumber:[{value:"",disabled:!1},[l.kI.required]],addresses:this.fb.array([])}),this.refresh()}refresh(){const e=this.authenticationService.getCurrentUser();e&&e.email?this.user$=this.userProfileService.getUser(e).pipe((0,d.b)(e=>{var t;this.userFormGroup.patchValue(e),null===(t=e.addresses)||void 0===t||t.forEach(e=>{const t=this.fb.group({streetnumber:[{value:e.streetnumber,disabled:!1},[l.kI.required]],streetname:[{value:e.streetname,disabled:!1},[]],city:[{value:e.city,disabled:!1},[l.kI.required]],state:[{value:e.state,disabled:!1},[l.kI.required]],zip:[{value:e.zip,disabled:!1},[l.kI.required]],id:[e.id]});this.addresses.push(t)})})):this.router.navigate(["/"])}get addresses(){return this.userFormGroup.get("addresses")}addAddress(){const e=this.fb.group({streetnumber:[{value:"",disabled:!1},[l.kI.required]],streetname:[{value:"",disabled:!1},[]],city:[{value:"",disabled:!1},[l.kI.required]],state:[{value:"Telangana",disabled:!1},[l.kI.required]],zip:[{value:"",disabled:!1},[l.kI.required]],id:[0]});this.addresses.push(e)}showAddressDialog(e){const t=this.authenticationService.getCurrentUser(),r=this.modalService.open(v);r.componentInstance.id=e,r.componentInstance.userId=null==t?void 0:t.email,r.result.then(e=>{e&&(this.toastService.showSuccess(e),this.refresh())}).catch(console.error)}save(e){const t=Object.assign({id:e,email:e},this.userFormGroup.value);this.userProfileService.save(t).subscribe(()=>{this.toastService.showSuccess("Profile successfully saved!!!"),this.route.snapshot.queryParams.returnUrl&&this.router.navigate([this.route.snapshot.queryParams.returnUrl])},e=>{this.toastService.showError("There was a problem saving the profile. Please try again.")})}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(l.qu),i.Y36(b.i),i.Y36(s.$),i.Y36(o.F0),i.Y36(q.k),i.Y36(g.FF),i.Y36(o.gz))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-user-profile"]],decls:4,vars:4,consts:[["loading",""],["class","container card bg-light","style","width: 36rem;",4,"ngIf","ngIfElse"],[1,"container","card","bg-light",2,"width","36rem"],[1,"row","g-5"],[1,"col-md","col-lg"],[1,"mb-3"],[1,"text-success","fs-3"],["novalidate","",1,"needs-validation",3,"id","formGroup","ngSubmit"],[1,"row","g-3"],[1,"col-sm-6"],["for","firstName",1,"form-label"],["type","text","id","firstName","formControlName","firstname","placeholder","","value","","required","",1,"form-control"],[1,"invalid-feedback"],["for","lastName",1,"form-label"],["type","text","id","lastName","formControlName","lastname","placeholder","","value","",1,"form-control"],["for","phoneNumber",1,"form-label"],["type","phone","id","phoneNumber","formControlName","phoneNumber","placeholder","","value","","required","",1,"form-control"],[1,"col-12"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-secondary",3,"click"],[4,"ngIf"],[1,"my-4"],[4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(i.YNc(0,T,1,0,"ng-template",null,0,i.W1O),i.YNc(2,U,34,5,"div",1),i.ALo(3,"async")),2&e){const e=i.MAs(1);i.xp6(2),i.Q6J("ngIf",i.lcZ(3,2,t.user$))("ngIfElse",e)}},directives:[n.O5,f.O,l._Y,l.JL,l.sg,l.Fj,l.JJ,l.u,l.Q7,n.sg],pipes:[n.Ov],styles:[""]}),e})();var I=r(5758),C=(()=>(function(e){e[e.CreditCard=0]="CreditCard",e[e.DebitCard=1]="DebitCard",e[e.UPI=2]="UPI"}(C||(C={})),C))();let S=(()=>{class e{constructor(e){this.http=e}save(e){return this.http.post(`${p.N.apiUrl}orders/`,e)}getOrder(e){return this.http.get(`${p.N.apiUrl}orders/${e}`)}getOrders(e){return this.http.get(`${p.N.apiUrl}orders?filter=${JSON.stringify(e)}`)}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(h.eN))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var k=r(2117),N=r(910),w=r(6215);const O=/(\d{1,4})/g,F=[{type:"maestro",patterns:[5018,502,503,506,56,58,639,6220,67],format:O,length:[12,13,14,15,16,17,18,19],cvvLength:[3],luhn:!0},{type:"forbrugsforeningen",patterns:[600],format:O,length:[16],cvvLength:[3],luhn:!0},{type:"dankort",patterns:[5019],format:O,length:[16],cvvLength:[3],luhn:!0},{type:"visa",patterns:[4],format:O,length:[13,16,19],cvvLength:[3],luhn:!0},{type:"mastercard",patterns:[51,52,53,54,55,22,23,24,25,26,27],format:O,length:[16],cvvLength:[3],luhn:!0},{type:"amex",patterns:[34,37],format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvvLength:[3,4],luhn:!0},{type:"dinersclub",patterns:[30,36,38,39],format:/(\d{1,4})(\d{1,6})?(\d{1,4})?/,length:[14],cvvLength:[3],luhn:!0},{type:"discover",patterns:[60,64,65,622],format:O,length:[16],cvvLength:[3],luhn:!0},{type:"unionpay",patterns:[62,88],format:O,length:[16,17,18,19],cvvLength:[3],luhn:!1},{type:"jcb",patterns:[35],format:O,length:[16,19],cvvLength:[3],luhn:!0}];class M{static cards(){return F}static cardFromNumber(e){e=(e+"").replace(/\D/g,"");for(let t=0,r=F.length;t<r;t++){const r=F[t],n=r.patterns;for(let t=0,i=n.length;t<i;t++){const i=n[t]+"";if(e.substr(0,i.length)===i)return r}}}static restrictNumeric(e){if(e.metaKey||e.ctrlKey)return!0;if(32===e.which)return!1;if(0===e.which)return!0;if(e.which<33)return!0;const t=String.fromCharCode(e.which);return!!/[\d\s]/.test(t)}static hasTextSelected(e){return null!==e.selectionStart&&e.selectionStart!==e.selectionEnd}static cardType(e){if(!e)return e;const t=this.cardFromNumber(e);return null!=t?t.type:null}static formatCardNumber(e){e=e.replace(/\D/g,"");const t=this.cardFromNumber(e);if(!t)return e;if(e=e.slice(0,t.length[t.length.length-1]),!t.format.global){const r=t.format.exec(e);if(null==r)return;return r.shift(),r.filter(Boolean).join(" ")}{const r=e.match(t.format);if(null!=r)return r.join(" ")}}static safeVal(e,t,r){let n=null;const i=t.value;let s=null;try{n=t.selectionStart}catch(o){}if(r(e),null!==n&&t===document.activeElement){if(n===i.length&&(n=e.length),i!==e){const t=i.slice(n-1,+n+1||9e9),r=e.slice(n-1,+n+1||9e9),s=e[n];/\d/.test(s)&&t===`${s} `&&r===` ${s}`&&(n+=1)}s=n}return s}static isCardNumber(e,t){const r=String.fromCharCode(e);if(!/^\d+$/.test(r))return!1;if(M.hasTextSelected(t))return!0;const n=(t.value+r).replace(/\D/g,""),i=M.cardFromNumber(n);return i?n.length<=i.length[i.length.length-1]:n.length<=16}static restrictExpiry(e,t){const r=String.fromCharCode(e);return!(!/^\d+$/.test(r)||this.hasTextSelected(t))&&`${t.value}${r}`.replace(/\D/g,"").length>6}static replaceFullWidthChars(e){null===e&&(e="");let t="";const r=e.split("");for(let n=0;n<r.length;n++){let e=r[n];const i="\uff10\uff11\uff12\uff13\uff14\uff15\uff16\uff17\uff18\uff19".indexOf(e);i>-1&&(e="0123456789"[i]),t+=e}return t}static formatExpiry(e){const t=e.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/);if(!t)return"";let r=t[1]||"",n=t[2]||"";const i=t[3]||"";return i.length>0?n=" / ":" /"===n?(r=r.substring(0,1),n=""):2===r.length||n.length>0?n=" / ":1===r.length&&"0"!==r&&"1"!==r&&(r=`0${r}`,n=" / "),`${r}${n}${i}`}static restrictCvc(e,t){const r=String.fromCharCode(e);return!(!/^\d+$/.test(r)||this.hasTextSelected(t))&&`${t.value}${r}`.length<=4}static luhnCheck(e){const t=e.split("").reverse();let r=!0,n=0;for(let i=0;i<t.length;i++){let e=parseInt(t[i],10);(r=!r)&&(e*=2),e>9&&(e-=9),n+=e}return n%10==0}}let J=(()=>{class e{constructor(e,t){this.el=e,this.control=t,this.cards=M.cards(),this.resolvedScheme$=new w.X("unknown"),this.target=this.el.nativeElement}updateValue(e){this.control?this.control.control.setValue(e):this.target.value=e}onKeypress(e){M.restrictNumeric(e)?M.isCardNumber(e.which,this.target)&&this.formatCardNumber(e):e.preventDefault()}onKeydown(e){this.formatBackCardNumber(e),this.reFormatCardNumber()}onKeyup(){this.setCardType()}onPaste(){this.reFormatCardNumber()}onChange(){this.reFormatCardNumber()}onInput(){this.reFormatCardNumber(),this.setCardType()}formatCardNumber(e){const t=String.fromCharCode(e.which);if(!/^\d+$/.test(t))return;const r=this.target.value;M.cardFromNumber(r+t),r.replace(/\D/g,"")}formatBackCardNumber(e){const t=this.target.value,r=this.target.selectionStart;8===e.which&&null!=r&&r===this.target.selectionEnd&&r>0&&r!==t.length&&" "===t[r-1]&&(e.preventDefault(),r<=2?(this.updateValue(t.slice(r)),this.target.selectionStart=0,this.target.selectionEnd=0):(this.updateValue(t.slice(0,r-2)+t.slice(r)),this.target.selectionStart=r-2,this.target.selectionEnd=r-2))}setCardType(){const e=M.cardType(this.target.value)||"unknown";this.resolvedScheme$.next(e),this.target.classList.contains(e)||(this.cards.forEach(e=>{this.target.classList.remove(e.type)}),this.target.classList.remove("unknown"),this.target.classList.add(e),this.target.classList.toggle("identified","unknown"!==e))}reFormatCardNumber(){const e=M.formatCardNumber(M.replaceFullWidthChars(this.target.value));e!==this.target.value&&(this.target.selectionStart=this.target.selectionEnd=M.safeVal(e,this.target,e=>{this.updateValue(e)}))}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(i.SBq),i.Y36(l.a5,10))},e.\u0275dir=i.lG2({type:e,selectors:[["","ccNumber",""]],hostBindings:function(e,t){1&e&&i.NdJ("keypress",function(e){return t.onKeypress(e)})("keydown",function(e){return t.onKeydown(e)})("keyup",function(){return t.onKeyup()})("paste",function(){return t.onPaste()})("change",function(){return t.onChange()})("input",function(){return t.onInput()})},exportAs:["ccNumber"]}),e})(),Y=(()=>{class e{constructor(e,t){this.el=e,this.control=t,this.target=this.el.nativeElement}updateValue(e){this.control?this.control.control.setValue(e):this.target.value=e}onKeypress(e){M.restrictNumeric(e)||M.restrictCvc(e.which,this.target)||e.preventDefault()}reformatCvc(){const e=M.replaceFullWidthChars(this.target.value).replace(/\D/g,"").slice(0,4);e!==this.target.value&&(this.target.selectionStart=this.target.selectionEnd=M.safeVal(e,this.target,e=>{this.updateValue(e)}))}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(i.SBq),i.Y36(l.a5,10))},e.\u0275dir=i.lG2({type:e,selectors:[["","ccCVC",""]],hostBindings:function(e,t){1&e&&i.NdJ("keypress",function(e){return t.onKeypress(e)})("paste",function(){return t.reformatCvc()})("change",function(){return t.reformatCvc()})("input",function(){return t.reformatCvc()})}}),e})(),$=(()=>{class e{constructor(e,t){this.el=e,this.control=t,this.target=this.el.nativeElement}updateValue(e){this.control?this.control.control.setValue(e):this.target.value=e}onKeypress(e){if(!M.restrictNumeric(e))return e.preventDefault(),!1;M.restrictExpiry(e.which,this.target)&&(this.formatExpiry(e),this.formatForwardSlashAndSpace(e),this.formatForwardExpiry(e))}onKeydown(e){M.restrictNumeric(e)&&M.restrictExpiry(e.which,this.target)&&this.formatBackExpiry(e)}onChange(){this.reformatExpiry()}onInput(){this.reformatExpiry()}formatExpiry(e){const t=String.fromCharCode(e.which),r=`${this.target.value}${t}`;if(/^\d+$/.test(t))if(/^\d$/.test(r)&&"0"!==r&&"1"!==r)e.preventDefault(),this.updateValue(`0${r} / `);else if(/^\d\d$/.test(r)){e.preventDefault();const t=parseInt(r[0],10),n=parseInt(r[1],10);this.updateValue(n>2&&0!==t?`0${t} / ${n}`:`${r} / `)}}formatForwardSlashAndSpace(e){const t=String.fromCharCode(e.which),r=this.target.value;if("/"!==t&&" "!==t)return!1;/^\d$/.test(r)&&"0"!==r&&this.updateValue(`0${r} / `)}formatForwardExpiry(e){const t=String.fromCharCode(e.which),r=this.target.value;!/^\d+$/.test(t)&&/^\d\d$/.test(r)&&this.updateValue(this.target.value=`${r} / `)}formatBackExpiry(e){const t=this.target.valueOf;8===e.which&&(null!=this.target.selectionStart&&this.target.selectionStart!==t.length||/\d\s\/\s$/.test(t)&&(e.preventDefault(),this.updateValue(t.replace(/\d\s\/\s$/,""))))}reformatExpiry(){const e=M.formatExpiry(M.replaceFullWidthChars(this.target.value));e!==this.target.value&&(this.target.selectionStart=this.target.selectionEnd=M.safeVal(e,this.target,e=>{this.updateValue(e)}))}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(i.SBq),i.Y36(l.a5,10))},e.\u0275dir=i.lG2({type:e,selectors:[["","ccExp",""]],hostBindings:function(e,t){1&e&&i.NdJ("keypress",function(e){return t.onKeypress(e)})("keydown",function(e){return t.onKeydown(e)})("change",function(){return t.onChange()})("input",function(){return t.onInput()})}}),e})(),E=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({}),e})();var P=r(6589);function L(e,t){1&e&&i._UZ(0,"app-spinner")}function Q(e,t){1&e&&(i.TgZ(0,"div"),i.TgZ(1,"div",5),i._uU(2,"Your cart is empty!"),i.qZA(),i.qZA())}function D(e,t){if(1&e&&(i.TgZ(0,"h4",6),i.TgZ(1,"span",7),i._uU(2,"Your cart"),i.qZA(),i.TgZ(3,"span",8),i._uU(4),i.qZA(),i.qZA()),2&e){const e=i.oxw().ngIf;i.xp6(4),i.Oqu(e.items.length)}}function B(e,t){if(1&e&&(i.TgZ(0,"span",15),i._uU(1),i.ALo(2,"currency"),i.qZA()),2&e){const e=i.oxw().$implicit;i.xp6(1),i.hij(" ",i.xi3(2,1,e.bookPrice*e.quantity,"INR")," ")}}function V(e,t){if(1&e&&(i.TgZ(0,"span",15),i._uU(1),i.ALo(2,"currency"),i.qZA()),2&e){const e=i.oxw().$implicit;i.xp6(1),i.hij(" ",i.xi3(2,1,e.offerPricingDetails.priceAfterDiscount*e.quantity,"INR")," ")}}function j(e,t){if(1&e&&(i.TgZ(0,"li",12),i.TgZ(1,"div"),i.TgZ(2,"h6",13),i._uU(3),i.qZA(),i.qZA(),i.YNc(4,B,3,4,"span",14),i.YNc(5,V,3,4,"span",14),i.qZA()),2&e){const e=t.$implicit,r=i.oxw(3);i.xp6(3),i.Oqu(e.description),i.xp6(1),i.Q6J("ngIf",e.itemType===r.cartItemType.book),i.xp6(1),i.Q6J("ngIf",e.itemType===r.cartItemType.offer)}}function G(e,t){if(1&e&&(i.TgZ(0,"ul",9),i.YNc(1,j,6,3,"li",10),i.TgZ(2,"li",11),i.TgZ(3,"span"),i._uU(4,"Shipping & Handling"),i.qZA(),i.TgZ(5,"strong"),i._uU(6),i.ALo(7,"currency"),i.qZA(),i.qZA(),i.TgZ(8,"li",11),i.TgZ(9,"span"),i._uU(10,"Total"),i.qZA(),i.TgZ(11,"strong"),i._uU(12),i.ALo(13,"currency"),i.qZA(),i.qZA(),i.qZA()),2&e){const e=i.oxw().ngIf;i.xp6(1),i.Q6J("ngForOf",e.items),i.xp6(5),i.Oqu(i.xi3(7,3,e.shippingCost,"INR")),i.xp6(6),i.Oqu(i.xi3(13,6,e.totalPlusShipping,"INR"))}}function H(e,t){if(1&e&&(i.TgZ(0,"div"),i.YNc(1,Q,3,0,"div",2),i.YNc(2,D,5,1,"h4",3),i.YNc(3,G,14,9,"ul",4),i.qZA()),2&e){const e=t.ngIf;i.xp6(1),i.Q6J("ngIf",!e.items||!e.items.length),i.xp6(1),i.Q6J("ngIf",e.items&&e.items.length),i.xp6(1),i.Q6J("ngIf",e.items&&e.items.length)}}let R=(()=>{class e{constructor(e,t,r){this.cartService=e,this.shippingService=t,this.modalService=r,this.cartItemType=P.hI}ngOnInit(){}refreshCart(){this.cart$=this.cartService.getItemsAllDetails(this.cartService.getItems()).pipe((0,d.b)(e=>{const t=e.items.map(e=>e.quantity).reduce((e,t)=>e+t,0);this.shippingService.getShippingCosts(t).subscribe(t=>{e.shippingCost=t,e.totalPlusShipping=e.total+t},console.error)}))}ngOnChanges(e){this.refreshCart()}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(N.N),i.Y36(k.N),i.Y36(g.FF))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-cart-summary"]],inputs:{cart$:"cart$"},features:[i.TTD],decls:4,vars:4,consts:[["loading",""],[4,"ngIf","ngIfElse"],[4,"ngIf"],["class","d-flex justify-content-between align-items-center mb-3",4,"ngIf"],["class","list-group mb-3",4,"ngIf"],[1,"p-3","mb-3","bg-warning","text-dark"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"text-primary"],[1,"badge","bg-primary","rounded-pill"],[1,"list-group","mb-3"],["class","list-group-item d-flex justify-content-between lh-sm",4,"ngFor","ngForOf"],[1,"list-group-item","d-flex","justify-content-between"],[1,"list-group-item","d-flex","justify-content-between","lh-sm"],[1,"my-0"],["class","text-muted",4,"ngIf"],[1,"text-muted"]],template:function(e,t){if(1&e&&(i.YNc(0,L,1,0,"ng-template",null,0,i.W1O),i.YNc(2,H,4,3,"div",1),i.ALo(3,"async")),2&e){const e=i.MAs(1);i.xp6(2),i.Q6J("ngIf",i.lcZ(3,2,t.cart$))("ngIfElse",e)}},directives:[n.O5,f.O,n.sg],pipes:[n.Ov,n.H9],styles:[""],changeDetection:0}),e})();function z(e,t){1&e&&i._UZ(0,"app-spinner")}function K(e,t){if(1&e){const e=i.EpF();i.ynx(0),i.TgZ(1,"div",9),i.TgZ(2,"input",40),i.NdJ("change",function(){const t=i.CHM(e).$implicit;return i.oxw(2).billingAddressChanged(t.id)}),i.qZA(),i.TgZ(3,"label",11),i._uU(4),i.qZA(),i.qZA(),i.BQk()}if(2&e){const e=t.$implicit,r=i.oxw(2);i.xp6(2),i.Q6J("checked",r.checkedBillingAddressId===e.id),i.xp6(2),i.xDo(" ",e.streetnumber," ",e.streetname," ",e.city," ",e.state," ",e.zip," ")}}function W(e,t){if(1&e){const e=i.EpF();i.ynx(0),i.TgZ(1,"div",9),i.TgZ(2,"input",41),i.NdJ("change",function(){const t=i.CHM(e).$implicit;return i.oxw(3).shippingAddressChanged(t.id)}),i.qZA(),i.TgZ(3,"address",11),i._uU(4),i.qZA(),i.qZA(),i.BQk()}if(2&e){const e=t.$implicit,r=i.oxw(3);i.xp6(2),i.Q6J("checked",r.checkedShippingAddressId===e.id),i.xp6(2),i.xDo(" ",e.streetnumber," ",e.streetname," ",e.city," ",e.state," ",e.zip," ")}}function X(e,t){if(1&e&&(i.ynx(0),i._UZ(1,"hr",29),i.TgZ(2,"h4",7),i._uU(3,"Shipping address"),i.qZA(),i.TgZ(4,"div",8),i.YNc(5,W,5,6,"ng-container",34),i.qZA(),i.BQk()),2&e){const e=i.oxw().ngIf;i.xp6(5),i.Q6J("ngForOf",e.addresses)}}const ee=function(){return["/user/profile"]},te=function(){return{returnUrl:"/user/checkout"}};function re(e,t){if(1&e){const e=i.EpF();i.TgZ(0,"div",8),i.TgZ(1,"h2",33),i._uU(2),i.qZA(),i.TgZ(3,"h4",7),i._uU(4,"Billing address"),i.qZA(),i.YNc(5,K,5,6,"ng-container",34),i._UZ(6,"hr",29),i.TgZ(7,"div",35),i.TgZ(8,"input",36),i.NdJ("change",function(){return i.CHM(e),i.oxw().sameAsBillingAddressChanged()}),i.qZA(),i.TgZ(9,"label",37),i._uU(10,"Shipping address is the same as my billing address"),i.qZA(),i.qZA(),i.YNc(11,X,6,1,"ng-container",38),i._UZ(12,"hr",29),i.TgZ(13,"div",8),i.TgZ(14,"button",39),i._uU(15,"Add/Update Address"),i.qZA(),i.TgZ(16,"button",39),i._uU(17,"Update Profile"),i.qZA(),i.qZA(),i.qZA()}if(2&e){const e=t.ngIf,r=i.oxw();i.xp6(2),i.AsE("",e.firstname," ",e.lastname,""),i.xp6(3),i.Q6J("ngForOf",e.addresses),i.xp6(3),i.Q6J("checked",r.sameAsBillingAddress),i.xp6(3),i.Q6J("ngIf",!r.sameAsBillingAddress),i.xp6(3),i.Q6J("routerLink",i.DdM(9,ee))("queryParams",i.DdM(10,te)),i.xp6(2),i.Q6J("routerLink",i.DdM(11,ee))("queryParams",i.DdM(12,te))}}let ne=(()=>{class e{constructor(e,t,r,n,i,s,o){this.userProfileService=e,this.authenticationService=t,this.orderService=r,this.router=n,this.shippingService=i,this.cartService=s,this.toastService=o,this.paymentMethod=C,this.sameAsBillingAddress=!0,this.payment={paymentMethod:C.CreditCard,nameOnCard:"",cardNumber:"",expiration:"",cVV:""}}ngOnInit(){this.refresh()}ngOnDestroy(){var e,t;null===(e=this.joinSubscription)||void 0===e||e.unsubscribe(),null===(t=this.saveSubscription)||void 0===t||t.unsubscribe()}refresh(){const e=this.authenticationService.getCurrentUser();e&&e.email?this.user$=this.userProfileService.getUser(e):this.router.navigate(["/"]),this.cart$=this.cartService.getItemsAllDetails(this.cartService.getItems()).pipe((0,d.b)(e=>{const t=e.items.map(e=>e.quantity).reduce((e,t)=>e+t,0);this.shippingService.getShippingCosts(t).subscribe(t=>{e.shippingCost=t,e.totalPlusShipping=e.total+t},console.error)}))}sameAsBillingAddressChanged(){this.sameAsBillingAddress=!this.sameAsBillingAddress,this.sameAsBillingAddress&&(this.checkedShippingAddressId=this.checkedBillingAddressId)}shippingAddressChanged(e){this.checkedShippingAddressId=e}billingAddressChanged(e){this.checkedBillingAddressId=e,this.sameAsBillingAddress&&(this.checkedShippingAddressId=e)}paymentMethodChanged(e){this.payment.paymentMethod=e}placeOrder(){this.joinSubscription=(0,I.D)([this.cart$,this.user$]).subscribe(([e,t])=>{let r={id:0,userId:t.id,subtotal:e.total,shippingCost:e.shippingCost,billingAddressId:this.checkedBillingAddressId,shippingAddressId:this.checkedShippingAddressId,firstname:t.firstname,lastname:t.lastname,phoneNumber:t.phoneNumber,items:e.items,bookItems:[],offerItems:[],payment:this.payment,date:new Date,billingAddressStreetnumber:"",billingAddressStreetname:"",billingAddressCity:"",billingAddressState:"",billingAddressZip:"",shippingAddressStreetnumber:"",shippingAddressStreetname:"",shippingAddressCity:"",shippingAddressState:"",shippingAddressZip:""};this.saveSubscription=this.orderService.save(r).subscribe(e=>{this.toastService.showSuccess("Your order was successfully placed. You will receive an email summarizing the order."),this.cartService.clearCart(),this.router.navigate([`user/order/${e.id}`])},e=>{this.toastService.showError("There was a problem processing your order. Please try again."),console.error(e)})})}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(b.i),i.Y36(s.$),i.Y36(S),i.Y36(o.F0),i.Y36(k.N),i.Y36(N.N),i.Y36(q.k))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-checkout"]],decls:56,vars:10,consts:[["loading",""],[1,"container"],[1,"row"],[1,"container","col-md-7","col-lg-8","bg-light"],[1,"needs-validation",3,"submit"],["checkoutForm","ngForm"],["class","my-3",4,"ngIf","ngIfElse"],[1,"mb-3"],[1,"my-3"],[1,"form-check"],["name","paymentMethod","type","radio","checked","","required","",1,"form-check-input",3,"change"],["for","credit",1,"form-check-label"],["id","debit","name","paymentMethod","type","radio","required","",1,"form-check-input",3,"change"],["for","debit",1,"form-check-label"],["id","upi","name","paymentMethod","type","radio","required","",1,"form-check-input",3,"change"],["for","upi",1,"form-check-label"],[1,"row","gy-3"],[1,"col-md-6"],["for","cc-name",1,"form-label"],["type","text","id","cc-name","name","cc-name","placeholder","","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"text-muted"],[1,"invalid-feedback"],["for","cc-number",1,"form-label"],["type","text","id","cc-number","name","cc-number","placeholder","","required","","ccNumber","",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-md-3"],["for","cc-expiration",1,"form-label"],["type","text","id","cc-expiration","name","cc-expiration","placeholder","","required","","ccExp","",1,"form-control",3,"ngModel","ngModelChange"],["for","cc-cvv",1,"form-label"],["type","text","id","cc-cvv","name","cc-cvv","placeholder","","required","","ccCVC","",1,"form-control",3,"ngModel","ngModelChange"],[1,"my-4"],["type","submit",1,"w-100","btn","btn-primary","btn-lg",3,"disabled"],[1,"col-md-5","col-lg-4","order-md-last"],[3,"cart$"],[1,"mb-3","text-logo-green"],[4,"ngFor","ngForOf"],[1,"form-check","form-switch"],["type","checkbox","id","same-address",1,"form-check-input",3,"checked","change"],["for","same-address",1,"form-check-label"],[4,"ngIf"],[1,"btn","btn-secondary","m-1",3,"routerLink","queryParams"],["name","billingAddressSelection","type","radio","required","",1,"form-check-input",3,"checked","change"],["name","shippingAddressSelection","type","radio","required","",1,"form-check-input",3,"checked","change"]],template:function(e,t){if(1&e&&(i.YNc(0,z,1,0,"ng-template",null,0,i.W1O),i.TgZ(2,"div",1),i.TgZ(3,"div",2),i.TgZ(4,"div",3),i.TgZ(5,"form",4,5),i.NdJ("submit",function(){return t.placeOrder()}),i.YNc(7,re,18,13,"div",6),i.ALo(8,"async"),i.TgZ(9,"h4",7),i._uU(10,"Payment"),i.qZA(),i.TgZ(11,"div",8),i.TgZ(12,"div",9),i.TgZ(13,"input",10),i.NdJ("change",function(){return t.paymentMethodChanged(t.paymentMethod.CreditCard)}),i.qZA(),i.TgZ(14,"label",11),i._uU(15,"Credit card"),i.qZA(),i.qZA(),i.TgZ(16,"div",9),i.TgZ(17,"input",12),i.NdJ("change",function(){return t.paymentMethodChanged(t.paymentMethod.DebitCard)}),i.qZA(),i.TgZ(18,"label",13),i._uU(19,"Debit card"),i.qZA(),i.qZA(),i.TgZ(20,"div",9),i.TgZ(21,"input",14),i.NdJ("change",function(){return t.paymentMethodChanged(t.paymentMethod.UPI)}),i.qZA(),i.TgZ(22,"label",15),i._uU(23,"UPI"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(24,"div",16),i.TgZ(25,"div",17),i.TgZ(26,"label",18),i._uU(27,"Name on card"),i.qZA(),i.TgZ(28,"input",19),i.NdJ("ngModelChange",function(e){return t.payment.nameOnCard=e}),i.qZA(),i.TgZ(29,"small",20),i._uU(30,"Full name as displayed on card"),i.qZA(),i.TgZ(31,"div",21),i._uU(32," Name on card is required "),i.qZA(),i.qZA(),i.TgZ(33,"div",17),i.TgZ(34,"label",22),i._uU(35,"Credit card number"),i.qZA(),i.TgZ(36,"input",23),i.NdJ("ngModelChange",function(e){return t.payment.cardNumber=e}),i.qZA(),i.TgZ(37,"div",21),i._uU(38," Credit card number is required "),i.qZA(),i.qZA(),i.TgZ(39,"div",24),i.TgZ(40,"label",25),i._uU(41,"Expiration"),i.qZA(),i.TgZ(42,"input",26),i.NdJ("ngModelChange",function(e){return t.payment.expiration=e}),i.qZA(),i.TgZ(43,"div",21),i._uU(44," Expiration date required "),i.qZA(),i.qZA(),i.TgZ(45,"div",24),i.TgZ(46,"label",27),i._uU(47,"CVV"),i.qZA(),i.TgZ(48,"input",28),i.NdJ("ngModelChange",function(e){return t.payment.cVV=e}),i.qZA(),i.TgZ(49,"div",21),i._uU(50," Security code required "),i.qZA(),i.qZA(),i.qZA(),i._UZ(51,"hr",29),i.TgZ(52,"button",30),i._uU(53,"Place your Order"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(54,"div",31),i._UZ(55,"app-cart-summary",32),i.qZA(),i.qZA(),i.qZA()),2&e){const e=i.MAs(1),r=i.MAs(6);i.xp6(7),i.Q6J("ngIf",i.lcZ(8,8,t.user$))("ngIfElse",e),i.xp6(21),i.Q6J("ngModel",t.payment.nameOnCard),i.xp6(8),i.Q6J("ngModel",t.payment.cardNumber),i.xp6(6),i.Q6J("ngModel",t.payment.expiration),i.xp6(6),i.Q6J("ngModel",t.payment.cVV),i.xp6(4),i.Q6J("disabled",r.invalid||!t.checkedBillingAddressId||!t.checkedShippingAddressId||0===t.checkedBillingAddressId||0===t.checkedShippingAddressId),i.xp6(3),i.Q6J("cart$",t.cart$)}},directives:[l._Y,l.JL,l.F,n.O5,l.Fj,l.Q7,l.JJ,l.On,J,$,Y,R,f.O,n.sg,o.rH],pipes:[n.Ov],styles:[""]}),e})();function ie(e,t){1&e&&i._UZ(0,"app-spinner")}function se(e,t){if(1&e&&i._UZ(0,"img",25),2&e){const e=i.oxw().$implicit;i.s9C("src",e.book.images[0].imageUrl,i.LSH)}}function oe(e,t){if(1&e&&(i.TgZ(0,"li",23),i.YNc(1,se,1,1,"img",24),i._uU(2),i.ALo(3,"currency"),i.ALo(4,"currency"),i.qZA()),2&e){const e=t.$implicit;i.xp6(1),i.Q6J("ngIf",e.book.images),i.xp6(1),i.HOy(" ",null==e.book?null:e.book.description," @ ",i.xi3(3,5,e.price,"INR")," * ",e.quantity," = ",i.xi3(4,8,e.price*e.quantity,"INR")," ")}}function ae(e,t){if(1&e&&(i.TgZ(0,"li"),i._uU(1),i.ALo(2,"currency"),i.qZA()),2&e){const e=t.$implicit;i.xp6(1),i.AsE(" ",null==e.book?null:e.book.description," @ ",i.xi3(2,2,null==e.book?null:e.book.price,"INR")," ")}}function ce(e,t){if(1&e&&(i.TgZ(0,"li"),i.TgZ(1,"h5",15),i._uU(2),i.qZA(),i._UZ(3,"img",26),i.TgZ(4,"h6",15),i._uU(5,"Books in offer"),i.qZA(),i.TgZ(6,"ol"),i.YNc(7,ae,3,5,"li",12),i.qZA(),i.TgZ(8,"div",27),i._uU(9,"Offer price after "),i.TgZ(10,"strong"),i._uU(11),i.qZA(),i._uU(12),i.ALo(13,"currency"),i.qZA(),i.qZA()),2&e){const e=t.$implicit,r=i.oxw(2);i.xp6(2),i.Oqu(e.offer.description),i.xp6(1),i.s9C("src",e.offer.imageUrl,i.LSH),i.s9C("alt",e.offer.description),i.xp6(4),i.Q6J("ngForOf",e.offer.offerItems),i.xp6(4),i.hij("",e.offer.discountPercentage,"%"),i.xp6(1),i.hij(" discount ",i.xi3(13,6,r.calculateOfferPrices(e.offer),"INR"),"")}}function le(e,t){if(1&e&&(i.ynx(0),i.TgZ(1,"div",2),i.TgZ(2,"div",3),i.TgZ(3,"div",4),i.TgZ(4,"h3",5),i._uU(5,"Your Order is Confirmed"),i.qZA(),i.TgZ(6,"p"),i._uU(7," An email has been sent to your mail address"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(8,"div",6),i.TgZ(9,"div",7),i.TgZ(10,"div",8),i.TgZ(11,"ul",9),i.TgZ(12,"li"),i.TgZ(13,"h5",10),i.TgZ(14,"u"),i._uU(15,"Books"),i.qZA(),i.qZA(),i.qZA(),i.YNc(16,oe,5,11,"li",11),i.YNc(17,ce,14,9,"li",12),i.qZA(),i.qZA(),i.qZA(),i.TgZ(18,"div",13),i.TgZ(19,"div",14),i.TgZ(20,"strong"),i._uU(21,"Shipped to:"),i.qZA(),i.TgZ(22,"address",15),i._uU(23),i.qZA(),i.qZA(),i.TgZ(24,"div",14),i.TgZ(25,"div",16),i.TgZ(26,"strong",16),i._uU(27," Billed To:"),i.qZA(),i.TgZ(28,"section",15),i._uU(29),i._UZ(30,"br"),i._uU(31),i._UZ(32,"br"),i._uU(33),i._UZ(34,"br"),i.qZA(),i.TgZ(35,"address",17),i._uU(36),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.TgZ(37,"div",3),i.TgZ(38,"div",18),i.TgZ(39,"div",13),i.TgZ(40,"h5"),i._uU(41,"Subtotal"),i.qZA(),i.qZA(),i.TgZ(42,"div",19),i.TgZ(43,"h5"),i._uU(44),i.ALo(45,"currency"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(46,"div",18),i.TgZ(47,"div",13),i.TgZ(48,"h5"),i._uU(49,"Shipping & Handling"),i.qZA(),i.qZA(),i.TgZ(50,"div",19),i.TgZ(51,"h5"),i._uU(52),i.ALo(53,"currency"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(54,"div",20),i.TgZ(55,"div",21),i.TgZ(56,"h5"),i._uU(57,"Total"),i.qZA(),i.qZA(),i.TgZ(58,"div",22),i.TgZ(59,"h5"),i._uU(60),i.ALo(61,"currency"),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.BQk()),2&e){const e=t.ngIf;i.xp6(16),i.Q6J("ngForOf",e.bookItems),i.xp6(1),i.Q6J("ngForOf",e.offerItems),i.xp6(6),i.Q0o(" ",e.firstname," ",e.lastname," ",e.shippingAddressStreetnumber," ",e.shippingAddressStreetname," ",e.shippingAddressCity," ",e.shippingAddressState," ",e.shippingAddressZip," "),i.xp6(6),i.hij(" ",null==e.payment?null:e.payment.nameOnCard,""),i.xp6(2),i.hij(" ",null==e.payment?null:e.payment.cardNumber,""),i.xp6(2),i.hij(" ",null==e.payment?null:e.payment.expiration,""),i.xp6(3),i.xDo(" ",e.billingAddressStreetnumber," ",e.billingAddressStreetname," ",e.billingAddressCity," ",e.billingAddressState," ",e.billingAddressZip," "),i.xp6(8),i.Oqu(i.xi3(45,20,e.subtotal,"INR")),i.xp6(8),i.Oqu(i.xi3(53,23,e.shippingCost,"INR")),i.xp6(8),i.Oqu(i.xi3(61,26,e.subtotal+e.shippingCost,"INR"))}}let de=(()=>{class e{constructor(e,t){this.orderservice=e,this.route=t}ngOnInit(){this.order$=this.orderservice.getOrder(+this.route.snapshot.params.id)}calculateOfferPrices(e){let t=e.offerItems.map(e=>{var t,r;return null!==(r=null===(t=e.book)||void 0===t?void 0:t.price)&&void 0!==r?r:0}).reduce((e,t)=>e+t,0);return t-t*e.discountPercentage/100}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(S),i.Y36(o.gz))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-order"]],decls:4,vars:4,consts:[["loading",""],[4,"ngIf","ngIfElse"],[1,"contaZ","ciner","bg-light"],[1,"card"],[1,"card-block","mx-3","my-3"],[1,"h3","card-title"],[1,"row"],[1,"col-md-7"],[1,"card","my-3"],[1,"confirm-page"],[1,"pt-1","text-underline"],["class","product my-3",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"col-md-5"],[1,"card","my-3","py-3","px-3"],[1,"py-3"],[1,""],[1,"bold"],[1,"row","px-3","py-2","border-bottom","mx-1"],[1,"col-md-6","text-end"],[1,"row","px-3","py-2","mx-1","thead"],[1,"col-xs-12","col-md-5"],[1,"col-xs-12","col-md-6","text-end"],[1,"product","my-3"],[3,"src",4,"ngIf"],[3,"src"],[1,"img-thumbnail","img-offerItem",3,"src","alt"],[1,"my-4"]],template:function(e,t){if(1&e&&(i.YNc(0,ie,1,0,"ng-template",null,0,i.W1O),i.YNc(2,le,62,29,"ng-container",1),i.ALo(3,"async")),2&e){const e=i.MAs(1);i.xp6(2),i.Q6J("ngIf",i.lcZ(3,2,t.order$))("ngIfElse",e)}},directives:[n.O5,f.O,n.sg],pipes:[n.Ov,n.H9],styles:["ul.confirm-page[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin-top:11px}ul.confirm-page[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:12px 0;background:#f6f6f6;padding:14px}img.img-offerItem[_ngcontent-%COMP%]{height:200px}ul.confirm-page[_ngcontent-%COMP%]{list-style:none}ul.confirm-page[_ngcontent-%COMP%]   li.product[_ngcontent-%COMP%]{margin:12px 0;background:#f6f6f6;padding:14px}"],changeDetection:0}),e})();function ue(e,t){1&e&&i._UZ(0,"app-spinner")}function ge(e,t){1&e&&(i.TgZ(0,"div"),i.TgZ(1,"div",19),i._uU(2,"No orders were found for the specified filter"),i.qZA(),i.qZA())}function pe(e,t){if(1&e&&(i.TgZ(0,"option",27),i._uU(1),i.qZA()),2&e){const e=t.$implicit;i.s9C("value",e.email),i.xp6(1),i.Oqu(e.email)}}function he(e,t){if(1&e){const e=i.EpF();i.TgZ(0,"select",25),i.NdJ("ngModelChange",function(t){return i.CHM(e),i.oxw(3).orderFilter.userId=t}),i.TgZ(1,"option"),i._uU(2,"All"),i.qZA(),i.YNc(3,pe,2,2,"option",26),i.qZA()}if(2&e){const e=t.ngIf,r=i.oxw(3);i.Q6J("ngModel",r.orderFilter.userId),i.xp6(3),i.Q6J("ngForOf",e)}}function me(e,t){if(1&e&&(i.TgZ(0,"div",20),i.TgZ(1,"div",21),i.TgZ(2,"label",22),i._uU(3,"Customer Id"),i.qZA(),i.qZA(),i.TgZ(4,"div",23),i.YNc(5,he,4,2,"select",24),i.ALo(6,"async"),i.qZA(),i.qZA()),2&e){const e=i.oxw(2),t=i.MAs(1);i.xp6(5),i.Q6J("ngIf",i.lcZ(6,2,e.users$))("ngIfElse",t)}}function fe(e,t){if(1&e&&(i.TgZ(0,"tr"),i._UZ(1,"td"),i.TgZ(2,"td"),i.TgZ(3,"a",30),i._uU(4),i.qZA(),i.qZA(),i.TgZ(5,"td"),i._uU(6),i.qZA(),i.TgZ(7,"td"),i._uU(8),i.qZA(),i.TgZ(9,"td"),i._uU(10),i.ALo(11,"date"),i.qZA(),i.TgZ(12,"td"),i._uU(13),i.ALo(14,"currency"),i.qZA(),i.qZA()),2&e){const e=t.$implicit;i.xp6(3),i.MGl("href","user/order/",e.id,"",i.LSH),i.xp6(1),i.hij("Order # ",e.bookItems.length?null==e.bookItems[0]||null==e.bookItems[0].book?null:e.bookItems[0].book.description:null==e.offerItems[0]||null==e.offerItems[0].offer?null:e.offerItems[0].offer.description,""),i.xp6(2),i.AsE("",e.bookItems.length?null==e.bookItems[0]||null==e.bookItems[0].book?null:e.bookItems[0].book.description:null==e.offerItems[0]||null==e.offerItems[0].offer?null:e.offerItems[0].offer.description," ",e.bookItems.length+e.offerItems.length>1?"plus "+(e.bookItems.length+e.offerItems.length-1)+" other item(s)":"",""),i.xp6(2),i.AsE("",e.firstname," ",e.lastname,""),i.xp6(2),i.Oqu(i.lcZ(11,8,e.date)),i.xp6(3),i.Oqu(i.xi3(14,10,e.subtotal+e.shippingCost,"INR"))}}function Ze(e,t){if(1&e&&(i.TgZ(0,"table",28),i.TgZ(1,"thead"),i.TgZ(2,"tr"),i._UZ(3,"th"),i.TgZ(4,"th"),i._uU(5,"Description"),i.qZA(),i.TgZ(6,"th"),i._uU(7,"Summary"),i.qZA(),i.TgZ(8,"th"),i._uU(9,"Customer name"),i.qZA(),i.TgZ(10,"th"),i._uU(11,"Placed on"),i.qZA(),i.TgZ(12,"th"),i._uU(13,"Total"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(14,"tbody"),i.YNc(15,fe,15,13,"tr",29),i.qZA(),i.qZA()),2&e){const e=i.oxw().ngIf;i.xp6(15),i.Q6J("ngForOf",e)}}function Ae(e,t){if(1&e){const e=i.EpF();i.TgZ(0,"div",2),i.YNc(1,ge,3,0,"div",3),i.TgZ(2,"form",4),i.NdJ("submit",function(){return i.CHM(e),i.oxw().applyFilter()}),i.TgZ(3,"div",5),i.YNc(4,me,7,4,"div",6),i.TgZ(5,"div",7),i.TgZ(6,"label",8),i._uU(7,"Date Range"),i.qZA(),i.qZA(),i.TgZ(8,"div",7),i.TgZ(9,"input",9),i.NdJ("ngModelChange",function(t){return i.CHM(e),i.oxw().orderFilter.dateRange.start=t}),i.qZA(),i.qZA(),i.TgZ(10,"div",7),i.TgZ(11,"label",10),i._uU(12,"To"),i.qZA(),i.qZA(),i.TgZ(13,"div",7),i.TgZ(14,"input",11),i.NdJ("ngModelChange",function(t){return i.CHM(e),i.oxw().orderFilter.dateRange.end=t}),i.qZA(),i.qZA(),i.TgZ(15,"div",12),i.TgZ(16,"label",13),i._uU(17,"Date Range shortcuts"),i.qZA(),i.TgZ(18,"nav",14),i.TgZ(19,"a",15),i._uU(20,"Today"),i.qZA(),i.TgZ(21,"a",15),i._uU(22,"Past week"),i.qZA(),i.TgZ(23,"a",15),i._uU(24,"Past month"),i.qZA(),i.TgZ(25,"a",15),i._uU(26,"Past year"),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.TgZ(27,"div",16),i.TgZ(28,"button",17),i._uU(29,"Filter"),i.qZA(),i.qZA(),i.qZA(),i.YNc(30,Ze,16,1,"table",18),i.qZA()}if(2&e){const e=t.ngIf,r=i.oxw();i.xp6(1),i.Q6J("ngIf",!e.length),i.xp6(3),i.Q6J("ngIf",r.authenticationService.isUserAdmin()),i.xp6(5),i.Q6J("ngModel",r.orderFilter.dateRange.start),i.xp6(5),i.Q6J("ngModel",r.orderFilter.dateRange.end),i.xp6(16),i.Q6J("ngIf",e)}}let ve=(()=>{class e{constructor(e,t,r){this.orderService=e,this.userProfileService=t,this.authenticationService=r}ngOnInit(){this.clearFilter(),this.users$=this.userProfileService.getUsers(),this.orders$=this.orderService.getOrders(this.orderFilter)}clearFilter(){this.orderFilter={userId:"All",dateRange:{}}}applyFilter(){this.orders$=this.orderService.getOrders(this.orderFilter)}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(S),i.Y36(b.i),i.Y36(s.$))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-orders"]],decls:4,vars:4,consts:[["loading",""],["class","container bg-light",4,"ngIf","ngIfElse"],[1,"container","bg-light"],[4,"ngIf"],["id","filters",1,"mb-2","pb-2",3,"submit"],[1,"row","py-3"],["class","",4,"ngIf"],[1,"col-auto"],["for","daterange",1,"col-form-label"],["type","date","name","dateRangeStart",1,"form-control",3,"ngModel","ngModelChange"],["for","daterange ",1,"col-form-label"],["type","date","name","dateRangeEnd",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-md-2","collapse"],[1,"col-form-label"],[1,"nav","flex-column"],[1,"btn","btn-outline-primary","btn-xs"],[1,"col","my-1"],["type","submit",1,"btn","btn-secondary"],["class","table table-striped","aria-labelledby","tableLabel",4,"ngIf"],[1,"p-3","mb-3","bg-warning","text-dark"],[1,""],[1,"col-md-3"],["for","userSelect",1,"col-form-label"],[1,"col-md-8"],["class","form-select mb-4","style","width:43% ;","name","userSelect",3,"ngModel","ngModelChange",4,"ngIf","ngIfElse"],["name","userSelect",1,"form-select","mb-4",2,"width","43%",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["aria-labelledby","tableLabel",1,"table","table-striped"],[4,"ngFor","ngForOf"],[3,"href"]],template:function(e,t){if(1&e&&(i.YNc(0,ue,1,0,"ng-template",null,0,i.W1O),i.YNc(2,Ae,31,5,"div",1),i.ALo(3,"async")),2&e){const e=i.MAs(1);i.xp6(2),i.Q6J("ngIf",i.lcZ(3,2,t.orders$))("ngIfElse",e)}},directives:[n.O5,f.O,l._Y,l.JL,l.F,l.Fj,l.JJ,l.On,l.EJ,l.YN,l.Kr,n.sg],pipes:[n.Ov,n.uU,n.H9],styles:[""]}),e})();var be=r(4466);let qe=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({imports:[[o.Bz.forChild([{path:"",component:a},{path:"login",component:a},{path:"checkout",component:ne,canActivate:[c]},{path:"orders",component:ve,canActivate:[c]},{path:"order/:id",component:de,canActivate:[c]},{path:"profile",component:_,canActivate:[c]}]),n.ez,l.u5,l.UX,E,be.m]]}),e})()}}]);